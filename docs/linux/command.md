# 常用命令

## crontab
通过 crontab 命令，可以在固定的间隔时间执行指定的命令或，这个命令非常适合周期性的、有规律的执行某些任务。
```shell
# .---------------- 分 (0 - 59)
# |  .------------- 时 (0 - 23)
# |  |  .---------- 日 (1 - 31)
# |  |  |  .------- 月 (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- 周 (0 - 6) (周天=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |
# *  *  *  *  * user-name  command to be executed
```
![img](/linux/crontab.jpeg)

>命令
```shell
# 查看当前用户的 crontab 文件
crontab -l
# 删除当前用户的 crontab 文件
crontab -r
# 编辑当前用户的 crontab 文件
crontab -e
# 列出某个用户的 crontab 文件
crontab -u username -l
# 编辑某个用户的 crontab 文件
crontab -u username -e
```

>创建定时任务的两种方式:
<br>`crontab -e`添加任务
<br>编辑`/etc/crontab`文件添加任务

可以用`-`来表示一段连续的时间周期，`/`表示执行任务的间隔时间。
>示例：
```shell
# 每分钟执行一次
* * * * * /bin/ls
# 周1到周5每天下午5点执行
0 17 * * 1-5 /usr/bin/rm -rf /tmp/*
# 每3小时执行一次
0 */3 * * * /etc/init.d/smb restart
# 每月1号和28号执行一次
0 0 1,28 * * fsck /home
```

## ps
用于显示当前进程的状态，类似于 windows 的任务管理器，格式为`ps [参数]`。
> 参数：
```md
-a：显示所有进程（包括其他用户的进程）
-u：用户以及其他详细信息
-x：显示没有控制终端的进程
```


Linux 系统进程有5种常见的进程状态，分别为运行、中断、不可中断、僵死与停止：
```md
R（运行）：进程正在运行或在运行队列中等待
S（中断）：进程处于休眠中，当某个条件形成后或者接收到信号时，则脱离该状态
D（不可中断）：进程不响应系统异步信号，即便用 kill 命令也不能将其中断
Z（僵死）：进程已经终止，但进程描述符依然存在, 直到父进程调用 wait4()系统函数
后将进程释放
T（停止）：进程收到停止信号后停止运行
```

当执行`ps -aux`命令后可以看到进程状态等信息：
![img](/ps.png)

>示例：
```shell
# 按内存资源的使用量对进程进行排序
ps -aux | sort -rnk 4
# 按 CPU 资源的使用量对进程进行排序
ps aux | sort -rnk 3
# 查找指定进程
ps -ef | grep nginx
```

## top
是一个在 Linux 和其他类 Unix 系统上常用的实时系统监控工具。它提供了一个动态的、交互式的实时视图，显示系统的整体性能信息以及正在运行的进程的相关信息。

![img](/top.png)

>显示信息:
```md
第1行：系统时间、运行时间、登录终端数、系统负载（三个数值分别为 1 分钟、5分钟、15 分钟内的平均值，数值越小意味着负载越低）。
第2行：进程总数、运行中的进程数、睡眠中的进程数、停止的进程数、僵死的进程数。
第3行：用户占用资源百分比、系统内核占用资源百分比、改变过优先级的进程资源百分比、空闲的资源百分比等。
第4行：物理内存总量、内存使用量、内存空闲量、作为内核缓存的内存量。
第5行：虚拟内存总量、虚拟内存使用量、虚拟内存空闲量、已被提前加载的内存量。
```

>进程信息：
```md
PID：进程的标识符。
USER：运行进程的用户名。
PR（优先级）：进程的优先级。
NI（Nice值）：进程的优先级调整值。
VIRT（虚拟内存）：进程使用的虚拟内存大小。
RES（常驻内存）：进程实际使用的物理内存大小。
SHR（共享内存）：进程共享的内存大小。
%CPU：进程占用 CPU 的使用率。
%MEM：进程占用内存的使用率。
TIME+：进程的累计 CPU 时间。
```

>示例：
```shell
# 设置信息更新周期为3秒
top -d 3
# 显示进程号为139的进程信息
top -p 669
# 更新10次后退出
top -n 10
```

## vim 
vim 是从 vi 发展出来的一个文本编辑器。代码补全、编译及错误跳转等方便编程的功能特别丰富，在程序员中被广泛使用，和 Emacs 并列成为类 Unix 系统用户最喜欢的文本编辑器。

>工作模式

vim 有命令、末行和编辑三种模式，每种模式分别又支持多种不同的命令快捷键，这大大提高了工作效率。
![img](/vim-1.png)
运行 vim 编辑器时，默认进入命令模式，此时需要先切换到输入模式后再进行文档编写工作，而每次在编写完文档后需要先返回命令模式，然后再进入末行模式，执行文档的保存或退出操作。在 vim 中，无法直接从输入模式切换到末行模式。

> vim 命令

```md
# 命令模式
  参数    说明
   i  |  在当前字符前插入文本 
   I  | 在行首插入文本 
   a  | 在当前字符后添加文本 
   A  | 在行末添加文本 
   o  | 在当前行后面插入一空行 
   O  | 在当前行前面插入一空行 
  dd  | 删除光标所在整行 
  5dd | 删除从光标处开始的5行
  yy  | 复制光标所在整行 
  5yy | 复制从光标处开始的5行 
   n  | 显示搜索命令定位到的下一个字符串 
   N  | 显示搜索命令定位到的上一个字符串 
   u  | 撤销上一步的操作 
   p  | 将之前删除或复制过的数据粘贴到光标后面 
```

```md
# 末行模式
  参数              说明
  :w            |   保存 
  :q            |   退出 
  :q!           |   强制退出 
  :wq!          |   强制保存退出 
  :set nu       |   显示行号 
  :set nonu     |   不显示行号 
  :命令          |   执行该命令 
  :整数         |    跳转到该行 
  \:s/one/two   |    将当前光标所在行的第一个 one 替换成 two 
  \:s/one/two/g |    将当前光标所在行的所有 one 替换成 two 
  :%s/one/two/g |    将全文中的所有 one 替换成 two 
  ?字符串        |    在文本中从下至上搜索该字符串 
  /字符串        |    在文本中从上至下搜索该字符串 
```

> vim 键盘图

![img](/vim-2.png)


## chmod
chmod 是控制用户对文件的权限的命令，Linux/Unix 的文件调用权限分为三级：文件所有者（Owner）、用户组（Group）、其它用户（Other Users）。
![](/file-2.png)